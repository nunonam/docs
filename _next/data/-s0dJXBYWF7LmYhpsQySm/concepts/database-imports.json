{"pageProps":{"frontmatter":{"title":"Database Imports","subtitle":"Import your data from an external MySQL database into your PlanetScale database."},"headings":[{"depth":2,"value":"Overview"},{"depth":2,"value":"Connect to your external database"},{"depth":3,"value":"Advanced settings"},{"depth":3,"value":"Test the connection"},{"depth":2,"value":"Import process"},{"depth":3,"value":"Step 1: Performing initial import"},{"depth":3,"value":"Step 2: Replica mode"},{"depth":3,"value":"Step 3: Primary mode "},{"depth":3,"value":"Import complete"},{"depth":2,"value":"Next steps"},{"depth":2,"value":"Import limitations"},{"depth":2,"value":"Troubleshooting connectivity issues"},{"depth":2,"value":"Troubleshooting compatibility issues"},{"depth":3,"value":"Foreign key constraints disallowed"},{"depth":3,"value":"No unique key"},{"depth":3,"value":"Invalid charset"},{"depth":3,"value":"Unsupported feature"},{"depth":3,"value":"Additional assistance"}],"body":{"compiledSource":"var h=Object.defineProperty,d=Object.defineProperties;var u=Object.getOwnPropertyDescriptors;var i=Object.getOwnPropertySymbols;var r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;var l=(a,t,o)=>t in a?h(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,e=(a,t)=>{for(var o in t||(t={}))r.call(t,o)&&l(a,o,t[o]);if(i)for(var o of i(t))s.call(t,o)&&l(a,o,t[o]);return a},p=(a,t)=>d(a,u(t));var c=(a,t)=>{var o={};for(var n in a)r.call(a,n)&&t.indexOf(n)<0&&(o[n]=a[n]);if(a!=null&&i)for(var n of i(a))t.indexOf(n)<0&&s.call(a,n)&&(o[n]=a[n]);return o};const makeShortcode=a=>function(o){return console.warn(\"Component \"+a+\" was not imported, exported, or provided by MDXProvider as global scope\"),mdx(\"div\",e({},o))},InfoBlock=makeShortcode(\"InfoBlock\"),layoutProps={},MDXLayout=\"wrapper\";function MDXContent(o){var n=o,{components:a}=n,t=c(n,[\"components\"]);return mdx(MDXLayout,p(e(e({},layoutProps),t),{components:a,mdxType:\"MDXLayout\"}),mdx(\"h2\",null,\"Overview\"),mdx(\"p\",null,\"PlanetScale provides an import tool in the dashboard that allows you to painlessly import an \",mdx(\"strong\",{parentName:\"p\"},\"existing internet-accessible MySQL database\"),\" into a PlanetScale database with \",mdx(\"em\",{parentName:\"p\"},\"no downtime\"),\".\"),mdx(\"p\",null,mdx(\"strong\",{parentName:\"p\"},\"This feature is currently in Limited Beta.\")),mdx(\"p\",null,\"Note: You must be an \",mdx(\"a\",e({parentName:\"p\"},{href:\"/concepts/access-control#organization-administrator\"}),\"Organization Administrator\"),\" to use this feature.\"),mdx(\"h2\",null,\"Connect to your external database\"),mdx(\"p\",null,'To import an existing database into PlanetScale, first head to your PlanetScale dashboard and click on \"',mdx(\"strong\",{parentName:\"p\"},\"New database\"),'\" > \"',mdx(\"strong\",{parentName:\"p\"},\"Import database\"),'\", which will bring you to the ',mdx(\"strong\",{parentName:\"p\"},\"Import Setup page\"),\".\"),mdx(InfoBlock,{type:\"note\",mdxType:\"InfoBlock\"},\"Importing a database will \",mdx(\"b\",null,\"not\"),\" count towards your \",mdx(\"inlineCode\",null,\"read\"),\" or \",mdx(\"inlineCode\",null,\"write\"),\" usage.\"),mdx(\"p\",null,\"Give your imported database a name and \",mdx(\"a\",e({parentName:\"p\"},{href:\"/concepts/regions\"}),\"select a region\"),\" from the dropdown. Next, you'll fill out some connection information so that we can import your data.\"),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/docs/database-import-planetscale.png\",alt:\"Select name and region for new database import\"}))),mdx(\"p\",null,\"Fill in the following values with information from your existing hosted database:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"Host name\"),\" \",\"\\u2014\",\" The address where the database is hosted. \"),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"Port\"),\" \",\"\\u2014\",\" The port where your database is hosted. The default MySQL port is \",mdx(\"inlineCode\",{parentName:\"li\"},\"3306\"),\".\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"SSL verification mode\"),\" \",\"\\u2014\",\" If your database server provides a valid SSL certificate, please set this to \",mdx(\"inlineCode\",{parentName:\"li\"},\"Required\"),\", otherwise select \",mdx(\"inlineCode\",{parentName:\"li\"},\"Disabled\"),\".\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"Database name\"),\" \",\"\\u2014\",\" The exact name of the database you want to import.\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"Username\"),\" \",\"\\u2014\",\" The username of the user used to connect to the database. This user \",mdx(\"strong\",{parentName:\"li\"},\"must\"),\" have \",mdx(\"inlineCode\",{parentName:\"li\"},\"read\"),\" and \",mdx(\"inlineCode\",{parentName:\"li\"},\"write\"),\" access.\")),mdx(InfoBlock,{type:\"note\",mdxType:\"InfoBlock\"},\"You must have \",mdx(\"a\",{href:\"https://dev.mysql.com/doc/internals/en/binary-log-overview.html\"},\"binary logs\"),\" enabled on the database you're importing.\"),mdx(\"p\",null,\"You'll have the option to \",mdx(\"strong\",{parentName:\"p\"},\"Authenticate with password\"),\" or \",mdx(\"strong\",{parentName:\"p\"},\"Authenticate with mTLS\"),\". To authenticate with password, type in the password for the username you entered. Make sure the user has \",mdx(\"inlineCode\",{parentName:\"p\"},\"read\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"write\"),\" access to this database.\"),mdx(\"p\",null,`For the \"Authenticate with mTLS option\", you'll need to provide the following:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"SSL client certificate\"),\" \",\"\\u2014\",\" Certificate to authenticate PlanetScale with your database server.\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"SSL client key\"),\" \",\"\\u2014\",\" This is the private key for the client certificate\")),mdx(\"p\",null,\"From here you, can proceed to \",mdx(\"a\",e({parentName:\"p\"},{href:\"#test-the-connection\"}),\"testing the connection\"),' or click \"',mdx(\"strong\",{parentName:\"p\"},\"Show advanced settings\"),'\" for more options.'),mdx(\"h3\",null,\"Advanced settings\"),mdx(\"p\",null,\"Under Advanced settings, you have the option to enter the following:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"SSL server name override\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"strong\",{parentName:\"li\"},\"SSL CA certificate chain\"),\" \",\"\\u2014\",\" If your database server provides a certificate with a non-trusted root CA, please provide the full CA certificate chain here.\")),mdx(\"p\",null,\"For more information about certificates from a Certificate Authority, check out our \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.planetscale.com/reference/secure-connections#certificate-authorities\"}),\"Secure connections documentation\"),\".\"),mdx(\"h3\",null,\"Test the connection\"),mdx(\"p\",null,'Once you have all of your connection information plugged in, click the \"',mdx(\"strong\",{parentName:\"p\"},\"Connect to database\"),`\" button. PlanetScale will attempt to connect to your database. If successful, you'll see a green checkmark with a success message. From here, you can click the \"`,mdx(\"strong\",{parentName:\"p\"},\"Begin database import\"),'\" button to import your data.'),mdx(\"p\",null,\"If the connection fails, you'll get an error message in the dashboard. Double-check your connection information or see our \",mdx(\"a\",e({parentName:\"p\"},{href:\"#troubleshooting-connectivity-issues\"}),\"Troubleshooting section\"),\" for more information.\"),mdx(\"h2\",null,\"Import process\"),mdx(\"p\",null,`There are four simple steps to the database import process. You can cancel the import at any time by clicking \"Cancel import\" in the top right corner. If you cancel, we'll delete all connection information. Note, you cannot run DDL (Data Definition Language), such as `,mdx(\"inlineCode\",{parentName:\"p\"},\"CREATE\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"ALTER\"),\", etc during the import process.\"),mdx(\"h3\",null,\"Step 1: Performing initial import\"),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/docs/database-imports-step-1.png\",alt:\"Step 1 of database import - Initial import\"}))),mdx(\"p\",null,\"During step one, the data and schema from your external database are imported into your PlanetScale database. The connection remains open during this phase and in \",mdx(\"inlineCode\",{parentName:\"p\"},\"read-only\"),\" mode.\"),mdx(\"p\",null,\"While in \",mdx(\"inlineCode\",{parentName:\"p\"},\"read-only\"),\" mode, you're already able to take advantage of PlanetScale features. You can generate a password to \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.planetscale.com/reference/secure-connections\"}),\"connect to your new database\"),\" in a MySQL client or \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.planetscale.com/tutorials/connect-any-application\"}),\"in your application locally\"),' by clicking the \"',mdx(\"strong\",{parentName:\"p\"},\"Connect\"),'\" dropdown underneath the import flow.'),mdx(\"p\",null,\"At this point, you can also view \",mdx(\"a\",e({parentName:\"p\"},{href:\"/concepts/query-statistics\"}),\"Query Statistics\"),\", branches, and database settings by clicking around in the top nav.\"),mdx(\"p\",null,\"Once the import is finished, your database is in Replica mode.\"),mdx(\"h3\",null,\"Step 2: Replica mode\"),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/docs/database-imports-step-2.png\",alt:\"Step 2 of database import - Replica mode\"}))),mdx(\"p\",null,\"While in Replica mode, we'll \",mdx(\"strong\",{parentName:\"p\"},\"continue watching your external database and automatically update your PlanetScale database\"),\" with any changes by utilizing \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://dev.mysql.com/doc/refman/8.0/en/binlog-replication-configuration-overview.html\"}),\"Binary Log File Replication\"),\".\"),mdx(\"p\",null,\"Queries will be served by PlanetScale and writes will be routed \",mdx(\"strong\",{parentName:\"p\"},\"back to your external database\"),\", and then replicated back to PlanetScale to stay in sync. \"),mdx(\"p\",null,\"Behind the scenes, we're using \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://vitess.io/docs/reference/features/schema-routing-rules/\"}),\"Vitess's powerful Schema Routing rules\"),', which essentially lets your PlanetScale database act as a \"data router\".'),mdx(\"p\",null,\"At this point, you can \",mdx(\"a\",e({parentName:\"p\"},{href:\"/tutorials/connect-any-application\"}),\"connect your live application\"),\" to the PlanetScale database and ensure that it is fully compatible with your app. \"),mdx(\"p\",null,\"In other words, any changes made to your data in your external database will also reflect in your PlanetScale database. For example, if a user makes a new comment on your blog application while you're importing, your PlanetScale database will be updated as well. This ensures you \",mdx(\"strong\",{parentName:\"p\"},\"won't experience any data loss\"),\" while going through the import process.\"),mdx(\"p\",null,'While in Replica mode, if any data changes are made to your PlanetScale database, those will not be replicated back to your external database. To replicate both ways, you need to turn on \"Primary mode\".'),mdx(\"p\",null,\"So, once you're ready for PlanetScale to become your \",mdx(\"em\",{parentName:\"p\"},\"primary\"),' database, click \"Enable primary mode\" to head to the next step.'),mdx(\"h3\",null,\"Step 3: Primary mode\"),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/docs/database-imports-step-3.png\",alt:\"Step 3 of database import - Primary mode\"}))),mdx(\"p\",null,\"During this step, PlanetScale becomes the primary database instead of your external database. It is now ready to accept both reads and writes. Behind the scenes, we essentially reverse the direction of the data routing from the previous step. This means that all reads and writes will go straight to your PlanetScale database and updates will be replicated back to your external database.\"),mdx(\"p\",null,\"In the context of the blog application example, this means that if a user makes a new comment, the comment will be written straight to the PlanetScale database and then essentially copied back to your external database as well. Why copy it back? If you decide you want to cancel the import and switch back to your external database, you can be confident that you didn't lose any new or changed data while going through the import process.\"),mdx(\"p\",null,`If you're happy with everything and ready to fully switch over, you can click on the \"`,mdx(\"strong\",{parentName:\"p\"},\"Finish\"),'\" to finalize the import.'),mdx(\"p\",null,`Once you finish the import, we will detach your external database. PlanetScale's connection to that database will be closed and all connection information will be deleted from PlanetScale. This will also cut off the \"data routing\" ability, so your PlanetScale database will no longer update your external database.`),mdx(\"h3\",null,\"Import complete\"),mdx(\"p\",null,\"Your database has been fully imported into PlanetScale and is ready to use! \"),mdx(\"p\",null,`Next, you'll be taken to your database overview page. If you click on \"Branches\", you'll see that you now have one `,mdx(\"a\",e({parentName:\"p\"},{href:\"/concepts/branching#branch-promotion\"}),\"production branch\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"main\"),\", that contains all of the data from your external database. Production branches are highly available and protected from direct schema changes. Your database is also on an \",mdx(\"a\",e({parentName:\"p\"},{href:\"/concepts/back-up-and-restore\"}),\"automatic backup schedule\"),\" whose frequency depends on your plan.\"),mdx(\"h2\",null,\"Next steps\"),mdx(\"p\",null,\"You just fully migrated over your database to PlanetScale with no downtime and no fear of data loss. So what's next? Here are some next steps you can take with your database:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"/tutorials/connect-any-application\"}),\"Connect to your application\"),\" \",\"\\u2014\",\" If you haven't already, you can also connect to your application locally. \"),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"/concepts/branching\"}),\"Create a development branch\"),\" \",\"\\u2014\",\" Add PlanetScale to your development workflow with our powerful branching feature. You can branch off of your \",mdx(\"inlineCode\",{parentName:\"li\"},\"main\"),\" branch to test schema changes in development, and then merge them into production with our \",mdx(\"a\",e({parentName:\"li\"},{href:\"/concepts/nonblocking-schema-changes\"}),\"non-blocking schema change workflow\"),\". Again, no downtime!\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"/concepts/branching#create-a-deploy-request\"}),\"Create a deploy request\"),\" \",\"\\u2014\",\" Once your branch is in production, you can safeguard against unwanted or accidental changes by creating a development branch off of your production branch. This is where you can test out schema changes or any modifications you need to make. Once it's ready, you can create a deploy request that your team can review before deploying to production.\")),mdx(\"h2\",null,\"Import limitations\"),mdx(\"p\",null,\"PlanetScale will automatically stop the import process and detach your external database after \",mdx(\"strong\",{parentName:\"p\"},\"7 days\"),\" of no activity once the initial import is finished. This will not impact your PlanetScale database that was created for the import, but it will stop all replication into and out of it. \"),mdx(\"h2\",null,\"Troubleshooting connectivity issues\"),mdx(\"p\",null,\"If you're running into issues connecting with a username and password, try to plug that same connection information into the MySQL CLI or a MySQL GUI. Below is the command for the MySQL CLI.\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{}),`mysql -u <username> -p <password> -h <host> -P <port> -D <database>\n`)),mdx(\"p\",null,\"If the connection works there, but not on PlanetScale, please \",mdx(\"a\",e({parentName:\"p\"},{href:\"#additional-assistance\"}),\"reach out for additional assistance\"),\".\"),mdx(\"h2\",null,\"Troubleshooting compatibility issues\"),mdx(\"p\",null,\"PlanetScale is built on \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://vitess.io/\"}),\"Vitess\"),\", which gives us the power to perform data migrations at scale. This does, however, come with some trade-offs that could cause you to run into errors while importing an existing database. We believe these small trade-offs are worth the massive benefits, such as unlimited scaling through horizontal sharding, non-blocking schema changes, branching, and more. So if you do run into any compatibility issues while importing your external database to PlanetScale, we'd like to help you troubleshoot.\"),mdx(\"p\",null,\"Below are a few common errors you may run into while importing or connecting to an external database. If you're still having trouble importing, please feel free to \",mdx(\"a\",e({parentName:\"p\"},{href:\"#additional-assistance\"}),\"reach out to support for additional assistance\"),\".\"),mdx(\"h3\",null,\"Foreign key constraints disallowed\"),mdx(\"p\",null,\"PlanetScale does not support database schemas that have tables with foreign keys in them.\"),mdx(\"p\",null,\"Please take a look at our help document on how your application can \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.planetscale.com/tutorials/operating-without-foreign-keys\"}),\"operate without foreign key constraints\"),\".\"),mdx(\"h3\",null,\"No unique key\"),mdx(\"p\",null,\"PlanetScale requires that all tables have a unique, not-null key that remains unchanged during the migration. If you run into this error, you can read through our \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.planetscale.com/tutorials/change-unique-key#how-to-change-a-table's-single-unique-key\"}),\"Change single unique key documentation\"),\" for more information.\"),mdx(\"p\",null,\"It may also help to check out the official \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://dev.mysql.com/doc/refman/8.0/en/partitioning-limitations-partitioning-keys-unique-keys.html\"}),\"MySQL documentation about Primary Keys\"),\".\"),mdx(\"h3\",null,\"Invalid charset\"),mdx(\"p\",null,\"PlanetScale supports the following charsets \",mdx(\"inlineCode\",{parentName:\"p\"},\"utf8\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"utf8mb4\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"utf8mb3\"),`.\nIf your table has any other charset, please consult the official `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://dev.mysql.com/doc/refman/8.0/en/charset.html\"}),\"MySQL documentation about charsets\"),\".\"),mdx(\"h3\",null,\"Unsupported feature\"),mdx(\"p\",null,\"You might see this error if your table requires a storage engine other than \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"InnoDB\")),`.\nPlease consult the official `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://dev.mysql.com/doc/refman/8.0/en/storage-engines.html\"}),\"MySQL documentation about alternative storage engines\"),\" for more information.\"),mdx(\"h3\",null,\"Additional assistance\"),mdx(\"p\",null,\"If you need additional assistance, contact our \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.planetscale.com/support\"}),\"PlanetScale's support team\"),\", or join our \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/planetscale/beta/discussions\"}),\"GitHub Discussion board\"),\".\"))}MDXContent.isMDXComponent=!0;\n","scope":{}},"fields":{"slug":"concepts/database-imports","lastUpdatedOn":"2021-12-25T02:34:04.660Z"}},"__N_SSG":true}